package com.offensive.mobilepentest;

import java.util.ArrayList;
import java.util.List;

/**
 * Represents a scanned host with its ports
 */
public class NmapHost {
    private String address;
    private String hostname;
    private List<NmapPort> ports;
    private boolean isUp;
    
    public NmapHost(String address) {
        this.address = address;
        this.ports = new ArrayList<>();
        this.isUp = false;
    }
    
    public NmapHost(String address, String hostname) {
        this.address = address;
        this.hostname = hostname;
        this.ports = new ArrayList<>();
        this.isUp = false;
    }
    
    public void addPort(NmapPort port) {
        ports.add(port);
        if (port.isOpen()) {
            isUp = true;
        }
    }
    
    public String getAddress() {
        return address;
    }
    
    public void setHostname(String hostname) {
        this.hostname = hostname;
    }
    
    public String getHostname() {
        return hostname;
    }
    
    public List<NmapPort> getPorts() {
        return ports;
    }
    
    public List<NmapPort> getOpenPorts() {
        List<NmapPort> openPorts = new ArrayList<>();
        for (NmapPort port : ports) {
            if (port.isOpen()) {
                openPorts.add(port);
            }
        }
        return openPorts;
    }
    
    public boolean isUp() {
        return isUp;
    }
    
    public void setUp(boolean isUp) {
        this.isUp = isUp;
    }
    
    public void setIsUp(boolean isUp) {
        this.isUp = isUp;
    }
}
