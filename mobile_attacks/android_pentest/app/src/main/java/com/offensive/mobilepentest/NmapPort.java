package com.offensive.mobilepentest;

/**
 * Represents a scanned port with its state and service info
 */
public class NmapPort {
    private int port;
    private String protocol;
    private boolean open;
    private boolean closed;
    private boolean filtered;
    private String service;
    private String banner;
    private String version;
    
    public NmapPort(int port, String protocol) {
        this.port = port;
        this.protocol = protocol;
        this.open = false;
        this.closed = false;
        this.filtered = false;
        this.service = "unknown";
    }
    
    public int getPort() {
        return port;
    }
    
    public String getProtocol() {
        return protocol;
    }
    
    public boolean isOpen() {
        return open;
    }
    
    public void setOpen(boolean open) {
        this.open = open;
        if (open) {
            this.closed = false;
            this.filtered = false;
        }
    }
    
    public boolean isClosed() {
        return closed;
    }
    
    public void setClosed(boolean closed) {
        this.closed = closed;
        if (closed) {
            this.open = false;
            this.filtered = false;
        }
    }
    
    public boolean isFiltered() {
        return filtered;
    }
    
    public void setFiltered(boolean filtered) {
        this.filtered = filtered;
        if (filtered) {
            this.open = false;
            this.closed = false;
        }
    }
    
    public String getState() {
        if (open) return "open";
        if (closed) return "closed";
        if (filtered) return "filtered";
        return "unknown";
    }
    
    public String getService() {
        return service;
    }
    
    public void setService(String service) {
        this.service = service;
    }
    
    public String getBanner() {
        return banner;
    }
    
    public void setBanner(String banner) {
        this.banner = banner;
    }
    
    public String getVersion() {
        return version;
    }
    
    public void setVersion(String version) {
        this.version = version;
    }
    
    @Override
    public String toString() {
        return port + "/" + protocol + " " + getState() + " " + service;
    }
}
